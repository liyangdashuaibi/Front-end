{"map":"{\"version\":3,\"sources\":[\"D:\\\\Tail\\\\Test\\\\Data-Binding\\\\src\\\\observer\\\\observer.js\",\"D:\\\\Tail\\\\Test\\\\Data-Binding\\\\src\\\\watcher\\\\watcher.js\",\"D:\\\\Tail\\\\Test\\\\Data-Binding\\\\src\\\\compile\\\\compile.js\",\"D:\\\\Tail\\\\Test\\\\Data-Binding\\\\src\\\\index.js\",\"D:\\\\Tail\\\\Test\\\\Data-Binding\\\\index.js\"],\"names\":[\"Observer\",\"data\",\"this\",\"walk\",\"observer\",\"val\",\"Dep\",\"subs\",\"Watcher\",\"vm\",\"exp\",\"fn\",\"get\",\"prototype\",\"Object\",\"keys\",\"forEach\",\"key\",\"defineReactive\",\"dep\",\"defineProperty\",\"enumerable\",\"configurable\",\"target\",\"addSub\",\"[object Object]\",\"newVal\",\"notify\",\"sub\",\"push\",\"updata\",\"run\",\"oldVal\",\"call\",\"watcher\",\"Compile\",\"el\",\"document\",\"querySelector\",\"fragment\",\"init\",\"nodeToFragment\",\"compileElement\",\"appendChild\",\"console\",\"log\",\"createDocumentFragment\",\"child\",\"firstChild\",\"childNodes\",\"slice\",\"node\",\"reg\",\"text\",\"innerText\",\"isTextNode\",\"test\",\"compileText\",\"exec\",\"length\",\"updateText\",\"value\",\"nodeType\",\"compile\",\"Binding\",\"options\",\"proxyKeys\",\"self\",\"set\",\"src\",\"body\",\"innerHTML\",\"selfVue\",\"a\",\"b\",\"c\",\"d\",\"e\",\"setTimeout\"],\"mappings\":\"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\",\"sourcesContent\":[\"function Observer (data) {\\r\\n    this.data = data;\\r\\n    this.walk(data);\\r\\n}\\r\\nObserver.prototype.walk = function (data) {\\r\\n    Object.keys(data).forEach((key) => {\\r\\n        this.defineReactive(data, key, data[key]);\\r\\n    })\\r\\n}\\r\\nObserver.prototype.defineReactive = function (data, key, val) {\\r\\n    var dep = new Dep();\\r\\n    var childObj = observer(val);\\r\\n    Object.defineProperty(data, key, {\\r\\n        enumerable: true,\\r\\n        configurable: true,\\r\\n        get () {\\r\\n            if (Dep.target) dep.addSub(Dep.target);\\r\\n            return val;\\r\\n        },\\r\\n        set (newVal) {\\r\\n            if (val === newVal) return;\\r\\n            val = newVal;\\r\\n            dep.notify();\\r\\n        }\\r\\n    })\\r\\n}\\r\\nfunction observer (val) {\\r\\n    if (!val || typeof val !== 'object') {\\r\\n        return;\\r\\n    }\\r\\n    return new Observer(val);\\r\\n}\\r\\n\\r\\nfunction Dep () {\\r\\n    this.subs = [];\\r\\n}\\r\\nDep.prototype.addSub = function (sub) {\\r\\n    this.subs.push(sub);\\r\\n}\\r\\nDep.prototype.notify = function () {\\r\\n    this.subs.forEach((sub) => {\\r\\n        sub.updata();\\r\\n    })\\r\\n}\\r\\nDep.target = null;\\r\\n\\r\\nexport { observer, Dep };\",\"import { Dep } from '../observer/observer';\\r\\n\\r\\nfunction Watcher (vm, exp, fn) {\\r\\n    this.vm = vm;\\r\\n    this.exp = exp;\\r\\n    this.fn = fn;\\r\\n    this.val = this.get();\\r\\n}\\r\\nWatcher.prototype.updata = function () {\\r\\n    this.run();\\r\\n}\\r\\nWatcher.prototype.run = function () {\\r\\n    var val = this.vm.data[this.exp];\\r\\n    var oldVal = this.val;\\r\\n    if (val !== oldVal) {\\r\\n        this.val = val;\\r\\n        this.fn.call(this.vm, val, oldVal);\\r\\n    }\\r\\n}\\r\\nWatcher.prototype.get = function () {\\r\\n    Dep.target = this;\\r\\n    var val = this.vm.data[this.exp];\\r\\n    Dep.target = null;\\r\\n    return val;\\r\\n}\\r\\n\\r\\nexport default Watcher;\",\"import Watcher from \\\"../watcher/watcher\\\";\\r\\n\\r\\nfunction Compile (el, vm) {\\r\\n    this.vm = vm;\\r\\n    this.el = document.querySelector(el);\\r\\n    this.fragment = null;\\r\\n    this.init();\\r\\n}\\r\\nCompile.prototype.init = function () {\\r\\n    if (this.el) {\\r\\n        this.fragment = this.nodeToFragment(this.el);\\r\\n        this.compileElement(this.fragment);\\r\\n        this.el.appendChild(this.fragment);\\r\\n    } else {\\r\\n        console.log(\\\"DOM元素不存在\\\")\\r\\n    }\\r\\n}\\r\\nCompile.prototype.nodeToFragment = function (el) {\\r\\n    var fragment = document.createDocumentFragment();\\r\\n    var child = el.firstChild;\\r\\n    while (child) {\\r\\n        fragment.appendChild(child);\\r\\n        child = el.firstChild;\\r\\n    }\\r\\n    return fragment;\\r\\n}\\r\\nCompile.prototype.compileElement = function (el) {\\r\\n    var childNodes = el.childNodes;\\r\\n    [].slice.call(childNodes).forEach(node => {\\r\\n        var reg = /\\\\{\\\\{(.*)\\\\}\\\\}/;\\r\\n        var text = node.innerText;\\r\\n        console.log(this.isTextNode(node) && reg.test(text))\\r\\n\\r\\n        if (this.isTextNode(node) && reg.test(text)) {\\r\\n            this.compileText(node, reg.exec(text)[1]);\\r\\n        } \\r\\n        else if (node.childNodes && node.childNodes.length) {\\r\\n            this.compileElement(node);\\r\\n        }\\r\\n    });\\r\\n}\\r\\nCompile.prototype.compileText = function (node, exp) {\\r\\n    var val = this.vm[exp];\\r\\n    this.updateText(node, val); // 将初始化的数据初始化到视图中\\r\\n    new Watcher(this.vm, exp, (value) => {\\r\\n        this.updateText(node, val);\\r\\n    })\\r\\n}\\r\\nCompile.prototype.updateText = function (node, val) {\\r\\n    node.innerText = typeof val == 'undefined' ? '' : val;\\r\\n}\\r\\nCompile.prototype.isTextNode = function (node) {\\r\\n    return node.nodeType == 3;\\r\\n}\\r\\n\\r\\nexport default Compile;\",\"import { observer } from \\\"./observer/observer\\\";\\r\\nimport Watcher from './watcher/watcher';\\r\\nimport Compile from './compile/compile';\\r\\n\\r\\nfunction Binding(options) {\\r\\n    this.vm = this;\\r\\n    this.data = options.data;\\r\\n    Object.keys(this.data).forEach( (key) => {\\r\\n        this.proxyKeys(key);\\r\\n    });\\r\\n    observer(this.data);\\r\\n    new Compile(options.el, this.vm);\\r\\n    return this;\\r\\n}\\r\\nBinding.prototype.proxyKeys = function (key) {\\r\\n    var self = this;\\r\\n    Object.defineProperty(this, key, {\\r\\n        enumerable: false,\\r\\n        configurable: true,\\r\\n        get: function proxyGetter() {\\r\\n            return self.data[key];\\r\\n        },\\r\\n        set: function proxySetter(newVal) {\\r\\n            self.data[key] = newVal;\\r\\n        }\\r\\n    })\\r\\n}\\r\\n\\r\\nexport default Binding;\",\"import Binding from './src/index';\\r\\n\\r\\ndocument.body.innerHTML = '<div id=\\\"app\\\"><p>{{ data.a }}</p><p>{{ data.b }}</p></div>'\\r\\n\\r\\nvar data = {\\r\\n    a: 1,\\r\\n    b: 2,\\r\\n    c: {\\r\\n        d: [\\r\\n            {\\r\\n                e: 3\\r\\n            }\\r\\n        ]\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\nvar selfVue = new Binding({\\r\\n    el: \\\"#app\\\",\\r\\n    data: data\\r\\n});\\r\\n\\r\\nsetTimeout(() => selfVue.a = 200, 2000)\"]}","code":"webpackHotUpdate(0,{\"./index.js\":function(t,e,i){\"use strict\";function n(t){this.data=t,this.walk(t)}function o(t){if(t&&\"object\"==typeof t)return new n(t)}function a(){this.subs=[]}function s(t,e,i){this.vm=t,this.exp=e,this.fn=i,this.val=this.get()}i.r(e),n.prototype.walk=function(t){Object.keys(t).forEach(e=>{this.defineReactive(t,e,t[e])})},n.prototype.defineReactive=function(t,e,i){var n=new a;o(i);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:()=>(a.target&&n.addSub(a.target),i),set(t){i!==t&&(i=t,n.notify())}})},a.prototype.addSub=function(t){this.subs.push(t)},a.prototype.notify=function(){this.subs.forEach(t=>{t.updata()})},a.target=null,s.prototype.updata=function(){this.run()},s.prototype.run=function(){var t=this.vm.data[this.exp],e=this.val;t!==e&&(this.val=t,this.fn.call(this.vm,t,e))},s.prototype.get=function(){a.target=this;var t=this.vm.data[this.exp];return a.target=null,t};var r=s;function h(t,e){this.vm=e,this.el=document.querySelector(t),this.fragment=null,this.init()}h.prototype.init=function(){this.el?(this.fragment=this.nodeToFragment(this.el),this.compileElement(this.fragment),this.el.appendChild(this.fragment)):console.log(\"DOM元素不存在\")},h.prototype.nodeToFragment=function(t){for(var e=document.createDocumentFragment(),i=t.firstChild;i;)e.appendChild(i),i=t.firstChild;return e},h.prototype.compileElement=function(t){var e=t.childNodes;[].slice.call(e).forEach(t=>{var e=/\\{\\{(.*)\\}\\}/,i=t.innerText;console.log(this.isTextNode(t)&&e.test(i)),this.isTextNode(t)&&e.test(i)?this.compileText(t,e.exec(i)[1]):t.childNodes&&t.childNodes.length&&this.compileElement(t)})},h.prototype.compileText=function(t,e){var i=this.vm[e];this.updateText(t,i),new r(this.vm,e,e=>{this.updateText(t,i)})},h.prototype.updateText=function(t,e){t.innerText=void 0===e?\"\":e},h.prototype.isTextNode=function(t){return 3==t.nodeType};var p=h;function c(t){return this.vm=this,this.data=t.data,Object.keys(this.data).forEach(t=>{this.proxyKeys(t)}),o(this.data),new p(t.el,this.vm),this}c.prototype.proxyKeys=function(t){var e=this;Object.defineProperty(this,t,{enumerable:!1,configurable:!0,get:function(){return e.data[t]},set:function(i){e.data[t]=i}})};var u=c;document.body.innerHTML='<div id=\"app\"><p>{{ data.a }}</p><p>{{ data.b }}</p></div>';var d=new u({el:\"#app\",data:{a:1,b:2,c:{d:[{e:3}]}}});setTimeout(()=>d.a=200,2e3)}});","extractedComments":[]}